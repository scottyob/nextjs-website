<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="preload" as="font" href="/_next/static/media/2aaf0723e720e8b9-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="preload" as="font" href="/_next/static/media/42e58f5a516ebb1b-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="preload" as="font" href="/_next/static/media/4e8dfc5aa8742fdc-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="preload" as="font" href="/_next/static/media/8679c800f1e60000-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="preload" as="font" href="/_next/static/media/d2c70a2e5d6bd385-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/0d26c7c4f71e78d1.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/386fa29998ac6a74.css" data-precedence="next"/><title>Scott O&#x27;Brien</title><meta name="description" content="My online creative outlet"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="__className_0ec1f4"><div class="flex max-w-full w-full flex-col pt-8 pb-8"><div class="self-center w-full"><h1 class="text-center text-4xl __className_baad2a"><a href="/">Scott O&#x27;Brien</a></h1><ul class="flex flex-wrap justify-center space-x-2 text-gray-400 italic pt-3 mb-8 max-w-2xl w-[80%] m-auto __className_6cf34a"><li class="transition group duration-300 whitespace-nowrap"><a href="/">Writings/Projects</a><span class="block group-hover:max-w-[70%] ml-2 transition-all duration-500 h-0.5 max-w-[70%] bg-orange-500"></span></li><li class="transition group duration-300 whitespace-nowrap"><a href="/about/">About</a><span class="block group-hover:max-w-[70%] ml-2 transition-all duration-500 h-0.5 max-w-0 bg-orange-50 group-hover:bg-orange-400"></span></li><li class="transition group duration-300 whitespace-nowrap"><a href="/bucketlist/">Bucket List</a><span class="block group-hover:max-w-[70%] ml-2 transition-all duration-500 h-0.5 max-w-0 bg-orange-50 group-hover:bg-orange-400"></span></li><li class="transition group duration-300 whitespace-nowrap"><a href="/recipes/">Cooking</a><span class="block group-hover:max-w-[70%] ml-2 transition-all duration-500 h-0.5 max-w-0 bg-orange-50 group-hover:bg-orange-400"></span></li><li class="transition group duration-300 whitespace-nowrap"><a href="/flying/">Flying</a><span class="block group-hover:max-w-[70%] ml-2 transition-all duration-500 h-0.5 max-w-0 bg-orange-50 group-hover:bg-orange-400"></span></li></ul></div><div class="w-full flex flex-col" id="main-content"><div class="self-center mt-7 max-w-2xl w-[80%]"><article class=""><div class="__className_af3318 mb-9"><h2 class="__className_59b087 text-2xl">2. Installing the Operating System</h2><div class="text-xs text-gray-400 italic mb-5">Created: <span>3/16/2011, 11:09:50 AM</span></div><div class="prose lg:prose-lg"><p>This is a post of a series for setting up a Fileserver with ZFS and OpenIndiana.  This post runs through setting up the operating system.</p>
<!-- -->
<h2>Installing OS and setup Network</h2>
<p>For the following set of posts, I have chosen to use VirtualBox to run through how to use ZFS in building your FileSystem. The first step is downloading and installing OpenIndiana. Get the latest build from <a href="http://openindiana.org/download/">http://openindiana.org/download/</a> (at the time of writing, I’m using oi-dev-148-x86) and install it onto your system. In VirtualBox I chose to install onto a 64 bit Solaris setup.
Make a hard disk when you’re setting up your VM image (I called mine OS_SSD1 because the HD is eventually going to be installed onto a solid state drive.)
Now, the VM is booted, we can start having some fun (SSH into it and Away we go)
Our first step is to setup the address for the box. I must admit, I’m pretty new to Solaris but from what I’ve found, we’ll run these commands to disable Auto Configuration via DHCP then enable our static config.</p>
<pre><code>svcadm disable physical:nwam 
svcadm enable physical:default
</code></pre>
<p>My fileserver is currently not on a domain (I’ll change this later), so I’ve added the line into my /etc/hosts file</p>
<pre><code>10.12.1.1 thumper.local thumper
</code></pre>
<p>Put your hostname that you want to use (‘thumper’ for me) in /etc/nodename
Your default gateway (routers) address should go in /etc/defaultrouter
The last thing to do is tell the host about what subnet it’s on, For me, I added (for my server subnet)</p>
<pre><code>10.12.1.0 255.255.255.0
</code></pre>
<p>The next step is set up your nameserver for DNS (/etc/resolv.conf) mine looks like this</p>
<pre><code>nameserver 10.12.1.254
</code></pre>
<p>Copy /etc/nsswitch.dns to /etc/nsswitch.conf – so dns is used.</p>
<p>Now so the adaptor comes up on boot, find out the status of your network I/O by running</p>
<pre><code>dladm show-link
</code></pre>
<p>(for me was e1000g0). Once you have this, you need to ‘plumbe” to set up the software in the kernel to set this interface on the TCP/IP stack.</p>
<pre><code>ifconfig e100g0 plumb 
echo 10.12.1.1/24 &gt; /etc/hostname.e100g0
</code></pre>
<p>Last but not least for your network stack,</p>
<pre><code>svcadm restart milestone/network
</code></pre>
<p>From this point on, that concludes the base setup with networking that I’m using for the FileServer. If this happened to be a critical server for you, perhaps you’d consider setting up <a href="http://darkstar-solaris.blogspot.com/2008/09/zfs-root-mirror.html">redundant bootable drives with ZFS</a>. It looks pretty cool.</p>
<p>Setting up the storage pool</p>
<p>Now we can get into the fun part. The first thing I want to do with this server is be able to store my data on it, so lets set up our storage pool. In my VM I’m using to test this I’ve added the disks I want to include in my pool (1GB disks for this test)</p>
<img src="/posts/2011/fileserver-1-os/image-7FQZVHEO.png"/>
<p>Once we’ve booted out VM (first thing I always do is ‘sudo bash’ because I’m evil in these silly little test environments).
I want to find out the device ID’s for these hard disks I just added</p>
<pre><code>root@thumper:~# iostat -En | egrep Size\|Soft 
c1t0d0 Soft Errors: 0 Hard Errors: 6 Transport Errors: 0 
Size: 0.00GB &lt;0 bytes&gt; 
c1t1d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 
Size: 17.18GB &lt;17179869184 bytes&gt; 
c1t2d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 
Size: 1.07GB &lt;1073741824 bytes&gt; 
c1t3d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 
Size: 1.07GB &lt;1073741824 bytes&gt; 
c1t4d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 
Size: 1.07GB &lt;1073741824 bytes&gt; 
c1t5d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 
Size: 1.07GB &lt;1073741824 bytes&gt;
</code></pre>
<p>As we can see, c1t0d0 is my CD-ROM drive, c1t1d0 is my hard disk, so I’ll want to create a Raidz-2 (two redundant drive) storage pool with the drives c1t2d0 c1t3d0 c1t4d0 c1t5d0</p>
<pre><code>root@thumper:~# **zpool create datastore raidz2 c1t2d0 c1t3d0 c1t4d0 c1t5d0**root@thumper:~# zpool list 
NAME SIZE ALLOC FREE CAP DEDUP HEALTH ALTROOT 
**datastore 3.94G 256K 3.94G 0% 1.00x ONLINE** – 
rpool 15.9G 4.17G 11.7G 26% 1.00x ONLINE – 
root@thumper:~# zfs list 
NAME USED AVAIL REFER MOUNTPOINT 
**datastore 128K 1.93G 44.8K /datastore**rpool 4.52G 11.1G 45K /rpool 
rpool/ROOT 3.61G 11.1G 31K legacy 
rpool/ROOT/openindiana 3.61G 11.1G 3.58G / 
rpool/dump 383M 11.1G 383M – 
rpool/export 1002K 11.1G 32K /export 
rpool/export/home 970K 11.1G 32K /export/home 
rpool/export/home/scott 938K 11.1G 938K /export/home/scott 
rpool/swap 544M 11.5G 187M –
</code></pre>
<p>We can see now we’ve created a pool of storage across our data (that’s zfs raided) that gives us double parity so we can loose two drives and still be running and we’ve got 2GB of usable space here (I’m using 1GB hard disks, in my real production box these will be 1TB disks).
Other posts to come in the series:</p>
<ol>
<li>Selecting the hardware</li>
<li>Installing the Operating System</li>
<li>Setting up File systems &amp; Snapshots</li>
<li>Allowing access through NFS &amp; SAMBA</li>
<li>Setting up encrypted off-site backups</li>
<li>Configuring Windows &amp; Linux clients to dump backup info to the FileServer</li>
<li>My router setup, configuring IP tables &amp; torrents on a low-powered server.</li>
</ol></div></div></article></div></div></div><script src="/_next/static/chunks/webpack-6854f8b189d0947c.js" async=""></script><script src="/_next/static/chunks/bce60fc1-e7cb3874f5f47943.js" async=""></script><script src="/_next/static/chunks/769-64fef319af2abb40.js" async=""></script><script src="/_next/static/chunks/main-app-7c73dbeff8b74fd8.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/2aaf0723e720e8b9-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/42e58f5a516ebb1b-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/media/4e8dfc5aa8742fdc-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n4:HL[\"/_next/static/css/0d26c7c4f71e78d1.css\",{\"as\":\"style\"}]\n0:\"$L5\"\n"])</script><script>self.__next_f.push([1,"6:HL[\"/_next/static/media/8679c800f1e60000-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n7:HL[\"/_next/static/media/d2c70a2e5d6bd385-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n8:HL[\"/_next/static/css/386fa29998ac6a74.css\",{\"as\":\"style\"}]\n"])</script><script>self.__next_f.push([1,"9:I{\"id\":\"8802\",\"chunks\":[\"272:static/chunks/webpack-6854f8b189d0947c.js\",\"253:static/chunks/bce60fc1-e7cb3874f5f47943.js\",\"769:static/chunks/769-64fef319af2abb40.js\"],\"name\":\"\",\"async\":false}\nb:I{\"id\":\"4299\",\"chunks\":[\"272:static/chunks/webpack-6854f8b189d0947c.js\",\"253:static/chunks/bce60fc1-e7cb3874f5f47943.js\",\"769:static/chunks/769-64fef319af2abb40.js\"],\"name\":\"\",\"async\":false}\nc:I{\"id\":\"7477\",\"chunks\":[\"477:static/chunks/477-6554af05b281746c.js\",\"153:static/chunks/153-7f7061897db69601.js\",\"651:static/"])</script><script>self.__next_f.push([1,"chunks/651-05a1ce4efc0860d4.js\",\"534:static/chunks/app/flying/location/[slug]/page-65be048863d8522d.js\"],\"name\":\"\",\"async\":false}\nd:I{\"id\":\"5212\",\"chunks\":[\"477:static/chunks/477-6554af05b281746c.js\",\"185:static/chunks/app/layout-9d8f06291be9ea84.js\"],\"name\":\"\",\"async\":false}\nf:I{\"id\":\"3211\",\"chunks\":[\"272:static/chunks/webpack-6854f8b189d0947c.js\",\"253:static/chunks/bce60fc1-e7cb3874f5f47943.js\",\"769:static/chunks/769-64fef319af2abb40.js\"],\"name\":\"\",\"async\":false}\n10:I{\"id\":\"5767\",\"chunks\":[\"272:static/chu"])</script><script>self.__next_f.push([1,"nks/webpack-6854f8b189d0947c.js\",\"253:static/chunks/bce60fc1-e7cb3874f5f47943.js\",\"769:static/chunks/769-64fef319af2abb40.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"5:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0d26c7c4f71e78d1.css\",\"precedence\":\"next\"}]],[\"$\",\"$L9\",null,{\"buildId\":\"7bnD85EgJ3cUdh6-mHFZs\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/post/2011/fileserver-1-os/\",\"initialTree\":[\"\",{\"children\":[\"(margined)\",{\"children\":[\"post\",{\"children\":[[\"slug\",\"2011/fileserver-1-os\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"2011\\\",\\\"fileserver-1-os\\\"]}\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[\"$La\",[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\"}]],\"globalErrorComponent\":\"$b\",\"notFound\":[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__className_0ec1f4\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex max-w-full w-full flex-col pt-8 pb-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"self-center w-full\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-center text-4xl __className_baad2a\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"/\",\"children\":\"Scott O'Brien\"}]}],[\"$\",\"$Ld\",null,{}]]}],[\"$\",\"div\",null,{\"className\":\"w-full flex flex-col\",\"id\":\"main-content\",\"children\":[\"$Le\",\"$undefined\",[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]]}]]}]}]}],\"asNotFound\":false,\"children\":[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__className_0ec1f4\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex max-w-full w-full flex-col pt-8 pb-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"self-center w-full\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-center text-4xl __className_baad2a\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"/\",\"children\":\"Scott O'Brien\"}]}],[\"$\",\"$Ld\",null,{}]]}],[\"$\",\"div\",null,{\"className\":\"w-full flex flex-col\",\"id\":\"main-content\",\"children\":[\"$\",\"$Lf\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L10\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[[\"$\",\"div\",null,{\"className\":\"self-center mt-7 max-w-2xl w-[80%]\",\"children\":[\"$\",\"$Lf\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(margined)\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L10\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$Lf\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(margined)\",\"children\",\"post\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L10\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$Lf\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(margined)\",\"children\",\"post\",\"children\",[\"slug\",\"2011/fileserver-1-os\",\"c\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L10\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$L11\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":[\\\"2011\\\",\\\"fileserver-1-os\\\"]}\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/386fa29998ac6a74.css\",\"precedence\":\"next\"}]]}],\"segment\":[\"slug\",\"2011/fileserver-1-os\",\"c\"]},\"styles\":[]}],\"segment\":\"post\"},\"styles\":[]}]}],null],\"segment\":\"(margined)\"},\"styles\":[]}]}]]}]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\na:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Scott O'Brien\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"My online creative outlet\"}],[\"$\",\"meta\",\"3\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"any\"}]]\n"])</script><script>self.__next_f.push([1,"12:I{\"id\":\"9114\",\"chunks\":[\"962:static/chunks/962-226f429e9782fad0.js\",\"726:static/chunks/app/(margined)/post/[...slug]/page-063ddffa9c53bc9d.js\"],\"name\":\"\",\"async\":false}\n13:I{\"id\":\"5470\",\"chunks\":[\"91:static/chunks/app/flying/flight/[slug]/page-5440ec33784e9466.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"11:[\"$\",\"article\",null,{\"className\":\"\",\"children\":[\"$\",\"div\",null,{\"className\":\"__className_af3318 mb-9\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"__className_59b087 text-2xl\",\"children\":\"2. Installing the Operating System\"}],[\"$\",\"div\",null,{\"className\":\"text-xs text-gray-400 italic mb-5\",\"children\":[\"Created: \",[\"$\",\"$L12\",null,{\"date\":\"$D2011-03-16T11:09:50.000Z\"}]]}],\"$undefined\",[\"$\",\"div\",null,{\"className\":\"prose lg:prose-lg\",\"children\":[\"$\",\"$L13\",null,{\"code\":\"var Component=(()=\u003e{var h=Object.create;var D=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var c=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty;var g=(r,e)=\u003e()=\u003e(e||r((e={exports:{}}).exports,e),e.exports),A=(r,e)=\u003e{for(var n in e)D(r,n,{get:e[n],enumerable:!0})},s=(r,e,n,d)=\u003e{if(e\u0026\u0026typeof e==\\\"object\\\"||typeof e==\\\"function\\\")for(let o of c(e))!p.call(r,o)\u0026\u0026o!==n\u0026\u0026D(r,o,{get:()=\u003ee[o],enumerable:!(d=$(e,o))||d.enumerable});return r};var m=(r,e,n)=\u003e(n=r!=null?h(u(r)):{},s(e||!r||!r.__esModule?D(n,\\\"default\\\",{value:r,enumerable:!0}):n,r)),C=r=\u003es(D({},\\\"__esModule\\\",{value:!0}),r);var l=g((v,i)=\u003e{i.exports=_jsx_runtime});var N={};A(N,{default:()=\u003eL,frontmatter:()=\u003ey});var t=m(l());var H=\\\"/posts/2011/fileserver-1-os/image-7FQZVHEO.png\\\";var y={title:\\\"2. Installing the Operating System\\\",author:\\\"scottyob\\\",type:\\\"post\\\",date:new Date(130027379e4),url:\\\"/2011/03/16/2-installing-the-operating-system/\\\",categories:[\\\"FileServer\\\"],tags:[\\\"fileserver\\\",\\\"ZFS\\\"],hero:\\\"image.png\\\",hideHero:!0};function a(r){let e=Object.assign({p:\\\"p\\\",h2:\\\"h2\\\",a:\\\"a\\\",pre:\\\"pre\\\",code:\\\"code\\\",ol:\\\"ol\\\",li:\\\"li\\\"},r.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.p,{children:\\\"This is a post of a series for setting up a Fileserver with ZFS and OpenIndiana.  This post runs through setting up the operating system.\\\"}),`\\n`,`\\n`,(0,t.jsx)(e.h2,{children:\\\"Installing OS and setup Network\\\"}),`\\n`,(0,t.jsxs)(e.p,{children:[\\\"For the following set of posts, I have chosen to use VirtualBox to run through how to use ZFS in building your FileSystem. The first step is downloading and installing OpenIndiana. Get the latest build from \\\",(0,t.jsx)(e.a,{href:\\\"http://openindiana.org/download/\\\",children:\\\"http://openindiana.org/download/\\\"}),` (at the time of writing, I\\\\u2019m using oi-dev-148-x86) and install it onto your system. In VirtualBox I chose to install onto a 64 bit Solaris setup.\\nMake a hard disk when you\\\\u2019re setting up your VM image (I called mine OS_SSD1 because the HD is eventually going to be installed onto a solid state drive.)\\nNow, the VM is booted, we can start having some fun (SSH into it and Away we go)\\nOur first step is to setup the address for the box. I must admit, I\\\\u2019m pretty new to Solaris but from what I\\\\u2019ve found, we\\\\u2019ll run these commands to disable Auto Configuration via DHCP then enable our static config.`]}),`\\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`svcadm disable physical:nwam \\nsvcadm enable physical:default\\n`})}),`\\n`,(0,t.jsx)(e.p,{children:\\\"My fileserver is currently not on a domain (I\\\\u2019ll change this later), so I\\\\u2019ve added the line into my /etc/hosts file\\\"}),`\\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`10.12.1.1 thumper.local thumper\\n`})}),`\\n`,(0,t.jsx)(e.p,{children:`Put your hostname that you want to use (\\\\u2018thumper\\\\u2019 for me) in /etc/nodename\\nYour default gateway (routers) address should go in /etc/defaultrouter\\nThe last thing to do is tell the host about what subnet it\\\\u2019s on, For me, I added (for my server subnet)`}),`\\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`10.12.1.0 255.255.255.0\\n`})}),`\\n`,(0,t.jsx)(e.p,{children:\\\"The next step is set up your nameserver for DNS (/etc/resolv.conf) mine looks like this\\\"}),`\\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`nameserver 10.12.1.254\\n`})}),`\\n`,(0,t.jsx)(e.p,{children:\\\"Copy /etc/nsswitch.dns to /etc/nsswitch.conf \\\\u2013 so dns is used.\\\"}),`\\n`,(0,t.jsx)(e.p,{children:\\\"Now so the adaptor comes up on boot, find out the status of your network I/O by running\\\"}),`\\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`dladm show-link\\n`})}),`\\n`,(0,t.jsx)(e.p,{children:\\\"(for me was e1000g0). Once you have this, you need to \\\\u2018plumbe\\\\u201D to set up the software in the kernel to set this interface on the TCP/IP stack.\\\"}),`\\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`ifconfig e100g0 plumb \\necho 10.12.1.1/24 \u003e /etc/hostname.e100g0\\n`})}),`\\n`,(0,t.jsx)(e.p,{children:\\\"Last but not least for your network stack,\\\"}),`\\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`svcadm restart milestone/network\\n`})}),`\\n`,(0,t.jsxs)(e.p,{children:[\\\"From this point on, that concludes the base setup with networking that I\\\\u2019m using for the FileServer. If this happened to be a critical server for you, perhaps you\\\\u2019d consider setting up \\\",(0,t.jsx)(e.a,{href:\\\"http://darkstar-solaris.blogspot.com/2008/09/zfs-root-mirror.html\\\",children:\\\"redundant bootable drives with ZFS\\\"}),\\\". It looks pretty cool.\\\"]}),`\\n`,(0,t.jsx)(e.p,{children:\\\"Setting up the storage pool\\\"}),`\\n`,(0,t.jsx)(e.p,{children:\\\"Now we can get into the fun part. The first thing I want to do with this server is be able to store my data on it, so lets set up our storage pool. In my VM I\\\\u2019m using to test this I\\\\u2019ve added the disks I want to include in my pool (1GB disks for this test)\\\"}),`\\n`,(0,t.jsx)(\\\"img\\\",{src:H}),`\\n`,(0,t.jsx)(e.p,{children:`Once we\\\\u2019ve booted out VM (first thing I always do is \\\\u2018sudo bash\\\\u2019 because I\\\\u2019m evil in these silly little test environments).\\nI want to find out the device ID\\\\u2019s for these hard disks I just added`}),`\\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`root@thumper:~# iostat -En | egrep Size\\\\\\\\|Soft \\nc1t0d0 Soft Errors: 0 Hard Errors: 6 Transport Errors: 0 \\nSize: 0.00GB \u003c0 bytes\u003e \\nc1t1d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 \\nSize: 17.18GB \u003c17179869184 bytes\u003e \\nc1t2d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 \\nSize: 1.07GB \u003c1073741824 bytes\u003e \\nc1t3d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 \\nSize: 1.07GB \u003c1073741824 bytes\u003e \\nc1t4d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 \\nSize: 1.07GB \u003c1073741824 bytes\u003e \\nc1t5d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 \\nSize: 1.07GB \u003c1073741824 bytes\u003e\\n`})}),`\\n`,(0,t.jsx)(e.p,{children:\\\"As we can see, c1t0d0 is my CD-ROM drive, c1t1d0 is my hard disk, so I\\\\u2019ll want to create a Raidz-2 (two redundant drive) storage pool with the drives c1t2d0 c1t3d0 c1t4d0 c1t5d0\\\"}),`\\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`root@thumper:~# **zpool create datastore raidz2 c1t2d0 c1t3d0 c1t4d0 c1t5d0**root@thumper:~# zpool list \\nNAME SIZE ALLOC FREE CAP DEDUP HEALTH ALTROOT \\n**datastore 3.94G 256K 3.94G 0% 1.00x ONLINE** \\\\u2013 \\nrpool 15.9G 4.17G 11.7G 26% 1.00x ONLINE \\\\u2013 \\nroot@thumper:~# zfs list \\nNAME USED AVAIL REFER MOUNTPOINT \\n**datastore 128K 1.93G 44.8K /datastore**rpool 4.52G 11.1G 45K /rpool \\nrpool/ROOT 3.61G 11.1G 31K legacy \\nrpool/ROOT/openindiana 3.61G 11.1G 3.58G / \\nrpool/dump 383M 11.1G 383M \\\\u2013 \\nrpool/export 1002K 11.1G 32K /export \\nrpool/export/home 970K 11.1G 32K /export/home \\nrpool/export/home/scott 938K 11.1G 938K /export/home/scott \\nrpool/swap 544M 11.5G 187M \\\\u2013\\n`})}),`\\n`,(0,t.jsx)(e.p,{children:`We can see now we\\\\u2019ve created a pool of storage across our data (that\\\\u2019s zfs raided) that gives us double parity so we can loose two drives and still be running and we\\\\u2019ve got 2GB of usable space here (I\\\\u2019m using 1GB hard disks, in my real production box these will be 1TB disks).\\nOther posts to come in the series:`}),`\\n`,(0,t.jsxs)(e.ol,{children:[`\\n`,(0,t.jsx)(e.li,{children:\\\"Selecting the hardware\\\"}),`\\n`,(0,t.jsx)(e.li,{children:\\\"Installing the Operating System\\\"}),`\\n`,(0,t.jsx)(e.li,{children:\\\"Setting up File systems \u0026 Snapshots\\\"}),`\\n`,(0,t.jsx)(e.li,{children:\\\"Allowing access through NFS \u0026 SAMBA\\\"}),`\\n`,(0,t.jsx)(e.li,{children:\\\"Setting up encrypted off-site backups\\\"}),`\\n`,(0,t.jsx)(e.li,{children:\\\"Configuring Windows \u0026 Linux clients to dump backup info to the FileServer\\\"}),`\\n`,(0,t.jsx)(e.li,{children:\\\"My router setup, configuring IP tables \u0026 torrents on a low-powered server.\\\"}),`\\n`]})]})}function R(r={}){let{wrapper:e}=r.components||{};return e?(0,t.jsx)(e,Object.assign({},r,{children:(0,t.jsx)(a,r)})):a(r)}var L=R;return C(N);})();\\n;return Component;\"}]}]]}]}]\n"])</script></body></html>