1:HL["/_next/static/css/3f39c10fbbbc2013.css",{"as":"style"}]
0:["VT6HUrkbdq8xqNXNA8sfL",[[["",{"children":["(navbar)",{"children":["(margined)",{"children":["post",{"children":[["slug","2011/fileserver-1-os","c"],{"children":["__PAGE__?{\"slug\":[\"2011\",\"fileserver-1-os\"]}",{}]}]}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/3f39c10fbbbc2013.css","precedence":"next"}]],"$L3"]]]]
4:HL["/_next/static/media/42e58f5a516ebb1b-s.p.woff2",{"as":"font","type":"font/woff2"}]
5:HL["/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2",{"as":"font","type":"font/woff2"}]
6:HL["/_next/static/media/d45575ed0ad4f563-s.p.woff2",{"as":"font","type":"font/woff2"}]
7:HL["/_next/static/css/d699b3284dd0f0c8.css",{"as":"style"}]
8:HL["/_next/static/media/8679c800f1e60000-s.p.woff2",{"as":"font","type":"font/woff2"}]
9:HL["/_next/static/media/af1939b13935fec8-s.p.woff2",{"as":"font","type":"font/woff2"}]
a:HL["/_next/static/css/e1665b43251c86eb.css",{"as":"style"}]
b:I{"id":7767,"chunks":["272:static/chunks/webpack-1b9985338a73b6a9.js","971:static/chunks/fd9d1056-f562485b1666a0a3.js","596:static/chunks/596-5b64dbf019a905f5.js"],"name":"default","async":false}
c:I{"id":7920,"chunks":["272:static/chunks/webpack-1b9985338a73b6a9.js","971:static/chunks/fd9d1056-f562485b1666a0a3.js","596:static/chunks/596-5b64dbf019a905f5.js"],"name":"default","async":false}
d:I{"id":6685,"chunks":["685:static/chunks/685-bd04e00715de5b93.js","222:static/chunks/222-0319df8e2b26098e.js","982:static/chunks/982-07d375c9d37b134d.js","46:static/chunks/app/(navbar)/(margined)/page-8bf83f1785e07527.js"],"name":"","async":false}
e:I{"id":2179,"chunks":["724:static/chunks/358ff52d-5af8921f222f7c20.js","122:static/chunks/e416a3ff-e7ae2f31ae45a9d1.js","447:static/chunks/00cbbcb7-5522c112e5f40d45.js","685:static/chunks/685-bd04e00715de5b93.js","713:static/chunks/app/(navbar)/layout-7ab2b37aff2ff4fb.js"],"name":"","async":false}
2:[["$","html",null,{"lang":"en","children":["$","$Lb",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Lc",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":[["$","body",null,{"className":"__className_e66fe9","children":["$","div",null,{"className":"flex max-w-full w-full flex-col pt-8 pb-8","children":[["$","div",null,{"className":"self-center w-full","children":[["$","h1",null,{"className":"text-center text-4xl __className_31da3a","children":["$","$Ld",null,{"href":"/","children":"Scott O'Brien"}]}],["$","$Le",null,{}]]}],["$","div",null,{"className":"w-full flex flex-col","id":"main-content","children":["$","$Lb",null,{"parallelRouterKey":"children","segmentPath":["children","(navbar)","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Lc",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":[["$","div",null,{"className":"self-center mt-7 max-w-2xl w-[80%]","children":["$","$Lb",null,{"parallelRouterKey":"children","segmentPath":["children","(navbar)","children","(margined)","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Lc",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$Lb",null,{"parallelRouterKey":"children","segmentPath":["children","(navbar)","children","(margined)","children","post","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Lc",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$Lb",null,{"parallelRouterKey":"children","segmentPath":["children","(navbar)","children","(margined)","children","post","children",["slug","2011/fileserver-1-os","c"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Lc",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$Lf",null],"segment":"__PAGE__?{\"slug\":[\"2011\",\"fileserver-1-os\"]}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/e1665b43251c86eb.css","precedence":"next"}]]}],"segment":["slug","2011/fileserver-1-os","c"]},"styles":[]}],"segment":"post"},"styles":[]}]}],null],"segment":"(margined)"},"styles":[]}]}]]}]}],null],"segment":"(navbar)"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/d699b3284dd0f0c8.css","precedence":"next"}]]}]}],null]
3:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Scott O'Brien"}],["$","meta","2",{"name":"description","content":"My online creative outlet"}],["$","meta","3",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","4",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}],["$","meta","5",{"name":"next-size-adjust"}]]
10:I{"id":8248,"chunks":["222:static/chunks/222-0319df8e2b26098e.js","982:static/chunks/982-07d375c9d37b134d.js","344:static/chunks/app/(navbar)/(margined)/post/[...slug]/page-98143d1a69f07e79.js"],"name":"","async":false}
11:I{"id":9098,"chunks":["222:static/chunks/222-0319df8e2b26098e.js","982:static/chunks/982-07d375c9d37b134d.js","344:static/chunks/app/(navbar)/(margined)/post/[...slug]/page-98143d1a69f07e79.js"],"name":"","async":false}
12:T1ed6,var Component=(()=>{var h=Object.create;var D=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var c=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty;var g=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),A=(r,e)=>{for(var n in e)D(r,n,{get:e[n],enumerable:!0})},s=(r,e,n,d)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of c(e))!p.call(r,o)&&o!==n&&D(r,o,{get:()=>e[o],enumerable:!(d=$(e,o))||d.enumerable});return r};var m=(r,e,n)=>(n=r!=null?h(u(r)):{},s(e||!r||!r.__esModule?D(n,"default",{value:r,enumerable:!0}):n,r)),C=r=>s(D({},"__esModule",{value:!0}),r);var l=g((v,i)=>{i.exports=_jsx_runtime});var N={};A(N,{default:()=>L,frontmatter:()=>y});var t=m(l());var H="/posts/2011/fileserver-1-os/image-7FQZVHEO.png";var y={title:"2. Installing the Operating System",author:"scottyob",type:"post",date:new Date(130027379e4),url:"/2011/03/16/2-installing-the-operating-system/",categories:["FileServer"],tags:["fileserver","ZFS"],hero:"image.png",hideHero:!0};function a(r){let e=Object.assign({p:"p",h2:"h2",a:"a",pre:"pre",code:"code",ol:"ol",li:"li"},r.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.p,{children:"This is a post of a series for setting up a Fileserver with ZFS and OpenIndiana.  This post runs through setting up the operating system."}),`
`,`
`,(0,t.jsx)(e.h2,{children:"Installing OS and setup Network"}),`
`,(0,t.jsxs)(e.p,{children:["For the following set of posts, I have chosen to use VirtualBox to run through how to use ZFS in building your FileSystem. The first step is downloading and installing OpenIndiana. Get the latest build from ",(0,t.jsx)(e.a,{href:"http://openindiana.org/download/",children:"http://openindiana.org/download/"}),` (at the time of writing, I\u2019m using oi-dev-148-x86) and install it onto your system. In VirtualBox I chose to install onto a 64 bit Solaris setup.
Make a hard disk when you\u2019re setting up your VM image (I called mine OS_SSD1 because the HD is eventually going to be installed onto a solid state drive.)
Now, the VM is booted, we can start having some fun (SSH into it and Away we go)
Our first step is to setup the address for the box. I must admit, I\u2019m pretty new to Solaris but from what I\u2019ve found, we\u2019ll run these commands to disable Auto Configuration via DHCP then enable our static config.`]}),`
`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`svcadm disable physical:nwam 
svcadm enable physical:default
`})}),`
`,(0,t.jsx)(e.p,{children:"My fileserver is currently not on a domain (I\u2019ll change this later), so I\u2019ve added the line into my /etc/hosts file"}),`
`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`10.12.1.1 thumper.local thumper
`})}),`
`,(0,t.jsx)(e.p,{children:`Put your hostname that you want to use (\u2018thumper\u2019 for me) in /etc/nodename
Your default gateway (routers) address should go in /etc/defaultrouter
The last thing to do is tell the host about what subnet it\u2019s on, For me, I added (for my server subnet)`}),`
`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`10.12.1.0 255.255.255.0
`})}),`
`,(0,t.jsx)(e.p,{children:"The next step is set up your nameserver for DNS (/etc/resolv.conf) mine looks like this"}),`
`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`nameserver 10.12.1.254
`})}),`
`,(0,t.jsx)(e.p,{children:"Copy /etc/nsswitch.dns to /etc/nsswitch.conf \u2013 so dns is used."}),`
`,(0,t.jsx)(e.p,{children:"Now so the adaptor comes up on boot, find out the status of your network I/O by running"}),`
`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`dladm show-link
`})}),`
`,(0,t.jsx)(e.p,{children:"(for me was e1000g0). Once you have this, you need to \u2018plumbe\u201D to set up the software in the kernel to set this interface on the TCP/IP stack."}),`
`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`ifconfig e100g0 plumb 
echo 10.12.1.1/24 > /etc/hostname.e100g0
`})}),`
`,(0,t.jsx)(e.p,{children:"Last but not least for your network stack,"}),`
`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`svcadm restart milestone/network
`})}),`
`,(0,t.jsxs)(e.p,{children:["From this point on, that concludes the base setup with networking that I\u2019m using for the FileServer. If this happened to be a critical server for you, perhaps you\u2019d consider setting up ",(0,t.jsx)(e.a,{href:"http://darkstar-solaris.blogspot.com/2008/09/zfs-root-mirror.html",children:"redundant bootable drives with ZFS"}),". It looks pretty cool."]}),`
`,(0,t.jsx)(e.p,{children:"Setting up the storage pool"}),`
`,(0,t.jsx)(e.p,{children:"Now we can get into the fun part. The first thing I want to do with this server is be able to store my data on it, so lets set up our storage pool. In my VM I\u2019m using to test this I\u2019ve added the disks I want to include in my pool (1GB disks for this test)"}),`
`,(0,t.jsx)("img",{src:H}),`
`,(0,t.jsx)(e.p,{children:`Once we\u2019ve booted out VM (first thing I always do is \u2018sudo bash\u2019 because I\u2019m evil in these silly little test environments).
I want to find out the device ID\u2019s for these hard disks I just added`}),`
`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`root@thumper:~# iostat -En | egrep Size\\|Soft 
c1t0d0 Soft Errors: 0 Hard Errors: 6 Transport Errors: 0 
Size: 0.00GB <0 bytes> 
c1t1d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 
Size: 17.18GB <17179869184 bytes> 
c1t2d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 
Size: 1.07GB <1073741824 bytes> 
c1t3d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 
Size: 1.07GB <1073741824 bytes> 
c1t4d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 
Size: 1.07GB <1073741824 bytes> 
c1t5d0 Soft Errors: 0 Hard Errors: 0 Transport Errors: 0 
Size: 1.07GB <1073741824 bytes>
`})}),`
`,(0,t.jsx)(e.p,{children:"As we can see, c1t0d0 is my CD-ROM drive, c1t1d0 is my hard disk, so I\u2019ll want to create a Raidz-2 (two redundant drive) storage pool with the drives c1t2d0 c1t3d0 c1t4d0 c1t5d0"}),`
`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:`root@thumper:~# **zpool create datastore raidz2 c1t2d0 c1t3d0 c1t4d0 c1t5d0**root@thumper:~# zpool list 
NAME SIZE ALLOC FREE CAP DEDUP HEALTH ALTROOT 
**datastore 3.94G 256K 3.94G 0% 1.00x ONLINE** \u2013 
rpool 15.9G 4.17G 11.7G 26% 1.00x ONLINE \u2013 
root@thumper:~# zfs list 
NAME USED AVAIL REFER MOUNTPOINT 
**datastore 128K 1.93G 44.8K /datastore**rpool 4.52G 11.1G 45K /rpool 
rpool/ROOT 3.61G 11.1G 31K legacy 
rpool/ROOT/openindiana 3.61G 11.1G 3.58G / 
rpool/dump 383M 11.1G 383M \u2013 
rpool/export 1002K 11.1G 32K /export 
rpool/export/home 970K 11.1G 32K /export/home 
rpool/export/home/scott 938K 11.1G 938K /export/home/scott 
rpool/swap 544M 11.5G 187M \u2013
`})}),`
`,(0,t.jsx)(e.p,{children:`We can see now we\u2019ve created a pool of storage across our data (that\u2019s zfs raided) that gives us double parity so we can loose two drives and still be running and we\u2019ve got 2GB of usable space here (I\u2019m using 1GB hard disks, in my real production box these will be 1TB disks).
Other posts to come in the series:`}),`
`,(0,t.jsxs)(e.ol,{children:[`
`,(0,t.jsx)(e.li,{children:"Selecting the hardware"}),`
`,(0,t.jsx)(e.li,{children:"Installing the Operating System"}),`
`,(0,t.jsx)(e.li,{children:"Setting up File systems & Snapshots"}),`
`,(0,t.jsx)(e.li,{children:"Allowing access through NFS & SAMBA"}),`
`,(0,t.jsx)(e.li,{children:"Setting up encrypted off-site backups"}),`
`,(0,t.jsx)(e.li,{children:"Configuring Windows & Linux clients to dump backup info to the FileServer"}),`
`,(0,t.jsx)(e.li,{children:"My router setup, configuring IP tables & torrents on a low-powered server."}),`
`]})]})}function R(r={}){let{wrapper:e}=r.components||{};return e?(0,t.jsx)(e,Object.assign({},r,{children:(0,t.jsx)(a,r)})):a(r)}var L=R;return C(N);})();
;return Component;f:["$","article",null,{"className":"","children":["$","div",null,{"className":"__className_12746b mb-9","children":[["$","h2",null,{"className":"__className_df02b7 text-2xl","children":"2. Installing the Operating System"}],["$","div",null,{"className":"text-xs text-gray-400 italic mb-5","children":["Created: ",["$","$L10",null,{"date":"$D2011-03-16T11:09:50.000Z"}]]}],"$undefined",["$","div",null,{"className":"prose lg:prose-lg","children":["$","$L11",null,{"code":"$12"}]}]]}]}]
