1:HL["/_next/static/media/2aaf0723e720e8b9-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/_next/static/media/42e58f5a516ebb1b-s.p.woff2",{"as":"font","type":"font/woff2"}]
3:HL["/_next/static/media/4e8dfc5aa8742fdc-s.p.woff2",{"as":"font","type":"font/woff2"}]
4:HL["/_next/static/css/0d26c7c4f71e78d1.css",{"as":"style"}]
0:["gPQXDX1rHIfH8VIPaGhiw",[[["",{"children":["(margined)",{"children":["post",{"children":[["slug","2012/srx-monitoring","c"],{"children":["__PAGE__?{\"slug\":[\"2012\",\"srx-monitoring\"]}",{}]}]}]}]},"$undefined","$undefined",true],"$L5",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/0d26c7c4f71e78d1.css","precedence":"next"}]],["$L6",["$","meta",null,{"name":"next-size-adjust"}]]]]]]
7:HL["/_next/static/media/8679c800f1e60000-s.p.woff2",{"as":"font","type":"font/woff2"}]
8:HL["/_next/static/media/d2c70a2e5d6bd385-s.p.woff2",{"as":"font","type":"font/woff2"}]
9:HL["/_next/static/css/386fa29998ac6a74.css",{"as":"style"}]
a:I{"id":"7477","chunks":["477:static/chunks/477-6554af05b281746c.js","153:static/chunks/153-7f7061897db69601.js","651:static/chunks/651-05a1ce4efc0860d4.js","534:static/chunks/app/flying/location/[slug]/page-65be048863d8522d.js"],"name":"","async":false}
b:I{"id":"5212","chunks":["477:static/chunks/477-6554af05b281746c.js","185:static/chunks/app/layout-9d8f06291be9ea84.js"],"name":"","async":false}
c:I{"id":"3211","chunks":["272:static/chunks/webpack-6854f8b189d0947c.js","253:static/chunks/bce60fc1-e7cb3874f5f47943.js","769:static/chunks/769-64fef319af2abb40.js"],"name":"","async":false}
d:I{"id":"5767","chunks":["272:static/chunks/webpack-6854f8b189d0947c.js","253:static/chunks/bce60fc1-e7cb3874f5f47943.js","769:static/chunks/769-64fef319af2abb40.js"],"name":"","async":false}
5:[["$","html",null,{"lang":"en","children":["$","body",null,{"className":"__className_0ec1f4","children":["$","div",null,{"className":"flex max-w-full w-full flex-col pt-8 pb-8","children":[["$","div",null,{"className":"self-center w-full","children":[["$","h1",null,{"className":"text-center text-4xl __className_baad2a","children":["$","$La",null,{"href":"/","children":"Scott O'Brien"}]}],["$","$Lb",null,{}]]}],["$","div",null,{"className":"w-full flex flex-col","id":"main-content","children":["$","$Lc",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Ld",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":[["$","div",null,{"className":"self-center mt-7 max-w-2xl w-[80%]","children":["$","$Lc",null,{"parallelRouterKey":"children","segmentPath":["children","(margined)","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Ld",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$Lc",null,{"parallelRouterKey":"children","segmentPath":["children","(margined)","children","post","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Ld",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$Lc",null,{"parallelRouterKey":"children","segmentPath":["children","(margined)","children","post","children",["slug","2012/srx-monitoring","c"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Ld",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$Le",null],"segment":"__PAGE__?{\"slug\":[\"2012\",\"srx-monitoring\"]}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/386fa29998ac6a74.css","precedence":"next"}]]}],"segment":["slug","2012/srx-monitoring","c"]},"styles":[]}],"segment":"post"},"styles":[]}]}],null],"segment":"(margined)"},"styles":[]}]}]]}]}]}],null]
6:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Scott O'Brien"}],["$","meta","2",{"name":"description","content":"My online creative outlet"}],["$","meta","3",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","4",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}]]
f:I{"id":"9114","chunks":["962:static/chunks/962-226f429e9782fad0.js","726:static/chunks/app/(margined)/post/[...slug]/page-7fc773434f18793a.js"],"name":"","async":false}
10:I{"id":"5470","chunks":["91:static/chunks/app/flying/flight/[slug]/page-5440ec33784e9466.js"],"name":"","async":false}
e:["$","article",null,{"className":"","children":["$","div",null,{"className":"__className_af3318 mb-9","children":[["$","h2",null,{"className":"__className_59b087 text-2xl","children":"Monitoring SRX Chassis Cluster"}],["$","div",null,{"className":"text-xs text-gray-400 italic mb-5","children":["Created: ",["$","$Lf",null,{"date":"$D2012-07-09T04:44:35.000Z"}]]}],"$undefined",["$","div",null,{"className":"prose lg:prose-lg","children":["$","$L10",null,{"code":"var Component=(()=>{var l=Object.create;var o=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var m=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),S=(t,e)=>{for(var s in e)o(t,s,{get:e[s],enumerable:!0})},i=(t,e,s,a)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let r of d(e))!f.call(t,r)&&r!==s&&o(t,r,{get:()=>e[r],enumerable:!(a=p(e,r))||a.enumerable});return t};var w=(t,e,s)=>(s=t!=null?l(g(t)):{},i(e||!t||!t.__esModule?o(s,\"default\",{value:t,enumerable:!0}):s,t)),T=t=>i(o({},\"__esModule\",{value:!0}),t);var u=m((N,c)=>{c.exports=_jsx_runtime});var v={};S(v,{default:()=>$,frontmatter:()=>C});var n=w(u()),C={title:\"Monitoring SRX Chassis Cluster\",author:\"scottyob\",type:\"post\",date:new Date(1341809075e3),url:\"/2012/07/09/monitoring-srx-chassis-cluster/\",categories:[\"nerd\"],tags:[\"Juniper\",\"Nagios\",\"SNMP\",\"SRX\"]};function h(t){let e=Object.assign({p:\"p\",pre:\"pre\",code:\"code\"},t.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"Just finishing off a few things at work this week. \\xA0We've got a few sites around the place where we have HA internet powered by two Juniper SRX100's. \\xA0The Two SRX100's operate in a Chassis Cluster and peer with our ISP using BGP across both active/passive devices.\"}),`\n`,`\n`,(0,n.jsx)(e.p,{children:\"Below is a little Nagios check script that I wrote to hook into our in-house Nagios monitoring platform. \\xA0It makes sure the chassis cluster has not failed over operating in a degraded state, and makes sure that there are two BGP peers connected.\"}),`\n`,(0,n.jsx)(e.p,{children:\"NOTE: \\xA0I was aiming for simplicity in this setup, if you've got a bigger environment or require instant notifications you might wish to set up snmp traps to get instant notifications.\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-#!/bin/bash\",children:`\n# Bash script to check the status of a SRX cluster.\n#  Works by SSHing into cluster to check \"show chassis cluster status\" command and SNMP walking to make sure BGP peers\n#  are both in a connected state\n\nSTATE_OK=0\nSTATE_WARNING=1\nSTATE_CRITICAL=2\nSTATE_UNKNOWN=3\n\nclusterAddress=$1\nprivateKey=$2\nclusterStatus=\\`ssh nagios@$clusterAddress -i $privateKey \"show chassis cluster status\"\\`\n\ndeclare -i primaryCount\ndeclare -i secondaryCount\ndeclare -i failoverCount\ndeclare -i activeBgpPeers\n\nactiveBgpPeers=\\`snmpwalk -Os -c public -v 1 $clusterAddress .1.3.6.1.2.1.15.3.1.2 | grep \"INTEGER: 6\" | wc -l\\`\nprimaryCount=\\`echo \"$clusterStatus\" | grep primary | wc -l\\`\nsecondaryCount=\\`echo \"$clusterStatus\" | grep secondary | wc -l\\`\nfailoverCount=\\`echo \"$clusterStatus\" | grep \"Failover count: 0\" | wc -l\\`\n\nif [ $primaryCount -ne 2 ]\nthen\n  echo \"No two primary redundancy groups\"\n  echo \"$clusterStatus\"\n  exit $STATE_CRITICAL\nfi\n\nif [ $secondaryCount -ne 2 ]\nthen\n  echo \"No two secondary redundancy groups\"\n  echo \"$clusterStatus\"\n  exit $STATE_CRITICAL\nfi\n\nif [ $failoverCount -ne 2 ]\nthen\n  echo \"SRX has fallen over on a redundancy group\"\n  echo \"$clusterStatus\"\n  exit $STATE_WARNING\nfi\n\nif [ $activeBgpPeers -ne 2 ]\nthen\n  echo \"NOT 2 Active BGP Peers\"\n  exit $STATE_CRITICAL\nfi\n\necho \"OK, 2 peers.  OK: Chassis Cluster status OK\"\necho \"$clusterStatus\"\nexit $STATE_OK\n`})}),`\n`,(0,n.jsx)(e.p,{children:\"\\xA0\"})]})}function y(t={}){let{wrapper:e}=t.components||{};return e?(0,n.jsx)(e,Object.assign({},t,{children:(0,n.jsx)(h,t)})):h(t)}var $=y;return T(v);})();\n;return Component;"}]}]]}]}]
