1:HL["/_next/static/media/2aaf0723e720e8b9-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/_next/static/media/42e58f5a516ebb1b-s.p.woff2",{"as":"font","type":"font/woff2"}]
3:HL["/_next/static/media/4e8dfc5aa8742fdc-s.p.woff2",{"as":"font","type":"font/woff2"}]
4:HL["/_next/static/css/0d26c7c4f71e78d1.css",{"as":"style"}]
0:["7bnD85EgJ3cUdh6-mHFZs",[[["",{"children":["(margined)",{"children":["post",{"children":[["slug","2012/georestricted-tunneling","c"],{"children":["__PAGE__?{\"slug\":[\"2012\",\"georestricted-tunneling\"]}",{}]}]}]}]},"$undefined","$undefined",true],"$L5",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/0d26c7c4f71e78d1.css","precedence":"next"}]],["$L6",["$","meta",null,{"name":"next-size-adjust"}]]]]]]
7:HL["/_next/static/media/8679c800f1e60000-s.p.woff2",{"as":"font","type":"font/woff2"}]
8:HL["/_next/static/media/d2c70a2e5d6bd385-s.p.woff2",{"as":"font","type":"font/woff2"}]
9:HL["/_next/static/css/386fa29998ac6a74.css",{"as":"style"}]
a:I{"id":"7477","chunks":["477:static/chunks/477-6554af05b281746c.js","153:static/chunks/153-7f7061897db69601.js","651:static/chunks/651-05a1ce4efc0860d4.js","534:static/chunks/app/flying/location/[slug]/page-65be048863d8522d.js"],"name":"","async":false}
b:I{"id":"5212","chunks":["477:static/chunks/477-6554af05b281746c.js","185:static/chunks/app/layout-9d8f06291be9ea84.js"],"name":"","async":false}
c:I{"id":"3211","chunks":["272:static/chunks/webpack-6854f8b189d0947c.js","253:static/chunks/bce60fc1-e7cb3874f5f47943.js","769:static/chunks/769-64fef319af2abb40.js"],"name":"","async":false}
d:I{"id":"5767","chunks":["272:static/chunks/webpack-6854f8b189d0947c.js","253:static/chunks/bce60fc1-e7cb3874f5f47943.js","769:static/chunks/769-64fef319af2abb40.js"],"name":"","async":false}
5:[["$","html",null,{"lang":"en","children":["$","body",null,{"className":"__className_0ec1f4","children":["$","div",null,{"className":"flex max-w-full w-full flex-col pt-8 pb-8","children":[["$","div",null,{"className":"self-center w-full","children":[["$","h1",null,{"className":"text-center text-4xl __className_baad2a","children":["$","$La",null,{"href":"/","children":"Scott O'Brien"}]}],["$","$Lb",null,{}]]}],["$","div",null,{"className":"w-full flex flex-col","id":"main-content","children":["$","$Lc",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Ld",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":[["$","div",null,{"className":"self-center mt-7 max-w-2xl w-[80%]","children":["$","$Lc",null,{"parallelRouterKey":"children","segmentPath":["children","(margined)","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Ld",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$Lc",null,{"parallelRouterKey":"children","segmentPath":["children","(margined)","children","post","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Ld",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$Lc",null,{"parallelRouterKey":"children","segmentPath":["children","(margined)","children","post","children",["slug","2012/georestricted-tunneling","c"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Ld",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$Le",null],"segment":"__PAGE__?{\"slug\":[\"2012\",\"georestricted-tunneling\"]}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/386fa29998ac6a74.css","precedence":"next"}]]}],"segment":["slug","2012/georestricted-tunneling","c"]},"styles":[]}],"segment":"post"},"styles":[]}]}],null],"segment":"(margined)"},"styles":[]}]}]]}]}]}],null]
6:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Scott O'Brien"}],["$","meta","2",{"name":"description","content":"My online creative outlet"}],["$","meta","3",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","4",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}]]
f:I{"id":"9114","chunks":["962:static/chunks/962-226f429e9782fad0.js","726:static/chunks/app/(margined)/post/[...slug]/page-063ddffa9c53bc9d.js"],"name":"","async":false}
10:I{"id":"5470","chunks":["91:static/chunks/app/flying/flight/[slug]/page-5440ec33784e9466.js"],"name":"","async":false}
e:["$","article",null,{"className":"","children":["$","div",null,{"className":"__className_af3318 mb-9","children":[["$","h2",null,{"className":"__className_59b087 text-2xl","children":"Easily accessing GeoIP restricted sites in your network."}],["$","div",null,{"className":"text-xs text-gray-400 italic mb-5","children":["Created: ",["$","$Lf",null,{"date":"$D2012-06-03T11:05:05.000Z"}]]}],"$undefined",["$","div",null,{"className":"prose lg:prose-lg","children":["$","$L10",null,{"code":"var Component=(()=>{var x=Object.create;var r=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var d=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty;var p=(E,e)=>()=>(e||E((e={exports:{}}).exports,e),e.exports),h=(E,e)=>{for(var t in e)r(E,t,{get:e[t],enumerable:!0})},Q=(E,e,t,s)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let o of u(e))!l.call(E,o)&&o!==t&&r(E,o,{get:()=>e[o],enumerable:!(s=m(e,o))||s.enumerable});return E};var g=(E,e,t)=>(t=E!=null?x(d(E)):{},Q(e||!E||!E.__esModule?r(t,\"default\",{value:E,enumerable:!0}):t,E)),k=E=>Q(r({},\"__esModule\",{value:!0}),E);var P=p((Z,i)=>{i.exports=_jsx_runtime});var f={};h(f,{default:()=>y,frontmatter:()=>w});var n=g(P());var a=\"/posts/2012/georestricted-tunneling/Network-Config-NXX6FUWM.jpg\";var w={title:\"Easily accessing GeoIP restricted sites in your network.\",author:\"scottyob\",type:\"post\",date:new Date(1338721505e3),url:\"/2012/06/03/easily-accessing-geoip-restricted-sites-in-your-network/\",categories:[\"nerd\"],hero:\"Network-Config.jpg\",hideHero:!0};function c(E){let e=Object.assign({p:\"p\",pre:\"pre\",code:\"code\"},E.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"We all know the problem, some sites are restricted to certain countries based on the IP address you're using to view them. \\xA0When trying to access over-seas, some solutions are HTTP proxies, Socks proxies and the like. \\xA0The problem I have with all of these is that they're annoying to set up whenever you want to to view the site and I don't want to have to do that for all my devices (iPad, computer, etc).\"}),`\n`,(0,n.jsx)(e.p,{children:\"This solution will tunnel only the sites you want over a VPN\\xA0connection\\xA0to be NAT'd out the other end, all on the gateway\"}),`\n`,`\n`,(0,n.jsx)(\"img\",{src:a,alt:\"Network Config\"}),`\n`,(0,n.jsx)(e.p,{children:\"First we want to set up OpenVPN on the remote host by issuing \\u201Copenvpn \\u2013genkey \\u2013secret static.key\\u201D then creating a file in (/etc/openvpn/server.conf)\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`# Network\nport 1194\nproto tcp-server\ndev tun\nifconfig 10.0.6.1 10.0.6.2\n\n# Crypto\nsecret /etc/openvpn/static.key\ncomp-lzo\nkeepalive 10 120\n\n# Security\npersist-key\npersist-tun\n\n# Logging\nstatus openvpn-status.log\n`})}),`\n`,(0,n.jsx)(e.p,{children:\"One thing we need to do on the server is set up NAT on the outbound address (to make sure all traffic that passes our VPS destined for the internet looks like it's from that US IP address)\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`# Previously initiated and accepted exchanges bypass rule checking\n# Allow unlimited outbound traffic\n/sbin/iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n/sbin/iptables -A OUTPUT -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT\n\niptables -t nat -A POSTROUTING -s 10.0.6.0/24 -o eth0 -j MASQUERADE\necho 1 > /proc/sys/net/ipv4/ip_forward\n`})}),`\n`,(0,n.jsx)(e.p,{children:\"On the client side, things look very similar,\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`remote vps.server.com 1194 tcp-client\npersist-key\ncomp-lzo no\nredirect-gateway def1\nnobind\npersist-tun\nsecret secret.key\ndev tun\nifconfig 10.0.6.2. 10.0.6.1\n`})}),`\n`,(0,n.jsx)(e.p,{children:\"On the client, I just also MASQUERADE'd data though (I know, double NAT'ing, easier then adjusting routing table on the VPS)\"}),`\n`,(0,n.jsx)(e.p,{children:\"Now for the magic to happen. I just replaced the DNS server on my home router with a little Python script (\\u2764\\uFE0F Twisted framework) to proxy requests, adding a tunnel for IP's that get returned by sites in my list (in this case I've chosen two fictious sites, HooLoo.com and pandoor.com\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-py\",children:`from twisted.internet.protocol import Factory, Protocol\nfrom twisted.internet import reactor\nfrom twisted.names import dns\nfrom twisted.names import client, server\nimport subprocess\nfrom sys import exit\n\ntunnelDomains = [\n  \"pandoor.com\",\n  \"hooloo.com\"\n]\ndnsServers = [(\"203.12.160.35\", 53), (\"203.12.160.36\", 53)]\n\ndef tunnel(address):\n       subprocess.call([\"route\", \"add\", address + \"/32\", \"tun0\"])  \n\nclass SpelDnsReolver(client.Resolver):\n  def filterAnswers(self, message):\n    if message.trunc:\n      return self.queryTCP(message.queries).addCallback(self.filterAnswers)\n    else:\n      for d in tunnelDomains:\n        if str(message.queries[0].name).endswith(d):\n          for answer in message.answers:\n            if answer.type == 1: #A record\n              tunnel(answer.payload.dottedQuad())\n\n    return (message.answers, message.authority, message.additional)\n\nverbosity = 0\nresolver = SpelDnsReolver(servers=dnsServers)\nf = server.DNSServerFactory(clients=[resolver], verbose=verbosity)\np = dns.DNSDatagramProtocol(f)\nf.noisy = p.noisy = verbosity\n\nreactor.listenUDP(53, p)\nreactor.listenTCP(53, f)\nreactor.run()\n`})})]})}function _(E={}){let{wrapper:e}=E.components||{};return e?(0,n.jsx)(e,Object.assign({},E,{children:(0,n.jsx)(c,E)})):c(E)}var y=_;return k(f);})();\n;return Component;"}]}]]}]}]
